THREE.OrbitControls=function(E,z,F){function A(b){if(!1!==a.enabled){b.preventDefault();var c=a.domElement===document?a.domElement.body:a.domElement;if(e===d.ROTATE){if(!0===a.noRotate)return;k.set(b.clientX,b.clientY);l.subVectors(k,m);a.rotateLeft(2*Math.PI*l.x/c.clientWidth*a.rotateSpeed);a.rotateUp(2*Math.PI*l.y/c.clientHeight*a.rotateSpeed);m.copy(k)}else if(e===d.DOLLY){if(!0===a.noZoom)return;n.set(b.clientX,b.clientY);v.subVectors(n,p);0<v.y?a.dollyIn():a.dollyOut();p.copy(n)}else if(e===
d.PAN){if(!0===a.noPan)return;q.set(b.clientX,b.clientY);w.subVectors(q,r);a.pan(w);r.copy(q)}a.update()}}function x(){!1!==a.enabled&&(window.removeEventListener("mousemove",A,!1),a.domElement.removeEventListener("mouseup",x,!1),window.removeEventListener("mouseup",x,!1),e=d.NONE)}function B(b){if(!1!==a.enabled&&!0!==a.noZoom){var c=0;b.wheelDelta?c=b.wheelDelta:b.detail&&(c=-b.detail);0<c?a.dollyOut():a.dollyIn()}}this.object=E;this.domElement=void 0!==z?z:document;this.enabled=!0;this.center=
this.target=new THREE.Vector3;this.noZoom=!1;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.staticMoving=!1;this.dynamicDampingFactor=.2;this.noRotate=!1;this.rotateSpeed=1;this.noPan=!1;this.keyPanSpeed=7;this.autoRotate=!1;this.autoRotateSpeed=2;this.stopAutoRotateWhenTuch=!1;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.noKeys=!1;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var a=this,m=new THREE.Vector2,k=new THREE.Vector2,l=new THREE.Vector2,r=new THREE.Vector2,q=new THREE.Vector2,
w=new THREE.Vector2,p=new THREE.Vector2,n=new THREE.Vector2,v=new THREE.Vector2,g=0,h=0,t=0,u=0,s=1,y=new THREE.Vector3,C=new THREE.Vector3,d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},e=d.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;this.autoRotate0=this.autoRotate;this.saveResetState=function(){this.position0.copy(this.object.position);this.zoom0=this.object.zoom;this.autoRotate0=this.autoRotate};var D=
{type:"change"};this.doStopAutoRotateOnTuch=function(){var b=F||a.stopAutoRotateOnTuchCallback;b&&b()};this.rotateLeft=function(b){void 0===b?(b=2*Math.PI/60/60*a.autoRotateSpeed,h-=b):this.staticMoving?h-=b:t-=b};this.rotateUp=function(b){void 0===b?(b=2*Math.PI/60/60*a.autoRotateSpeed,g-=b):this.staticMoving?g-=b:u-=b};this.panLeft=function(a){var c=new THREE.Vector3,d=this.object.matrix.elements;c.set(d[0],d[1],d[2]);c.multiplyScalar(-a);y.add(c)};this.panUp=function(a){var c=new THREE.Vector3,
d=this.object.matrix.elements;c.set(d[4],d[5],d[6]);c.multiplyScalar(a);y.add(c)};this.pan=function(b){var c=a.domElement===document?a.domElement.body:a.domElement;if(void 0!==a.object.fov){var d=a.object.position.clone().sub(a.target).length(),d=d*Math.tan(a.object.fov/2*Math.PI/180);a.panLeft(2*b.x*d/c.clientHeight);a.panUp(2*b.y*d/c.clientHeight)}else void 0!==a.object.top?(a.panLeft(b.x*(a.object.right-a.object.left)/c.clientWidth),a.panUp(b.y*(a.object.top-a.object.bottom)/c.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")};
this.dollyIn=function(b){void 0===b&&(b=Math.pow(.95,a.zoomSpeed));s/=b};this.dollyOut=function(b){void 0===b&&(b=Math.pow(.95,a.zoomSpeed));s*=b};this.update=function(){var b=this.object.position,c=b.clone().sub(this.target),d=Math.atan2(c.x,c.z),e=Math.atan2(Math.sqrt(c.x*c.x+c.z*c.z),c.y);this.autoRotate&&this.rotateLeft(2*Math.PI/60/60*a.autoRotateSpeed);if(!this.staticMoving){var f=t*this.dynamicDampingFactor;t-=f;h+=f}d+=h;this.staticMoving||(f=u*this.dynamicDampingFactor,u-=f,g+=f);e+=g;e=
Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,e));e=Math.max(1E-6,Math.min(Math.PI-1E-6,e));f=c.length()*s;f=Math.max(this.minDistance,Math.min(this.maxDistance,f));this.target.add(y);c.x=f*Math.sin(e)*Math.sin(d);c.y=f*Math.cos(e);c.z=f*Math.sin(e)*Math.cos(d);b.copy(this.target).add(c);this.object.lookAt(this.target);g=h=0;s=1;y.set(0,0,0);0<C.distanceTo(this.object.position)&&(this.dispatchEvent(D),C.copy(this.object.position))};this.reset=function(){e=d.NONE;this.target.copy(this.target0);
this.object.position.copy(this.position0);this.object.zoom=this.zoom0;this.autoRotate=this.autoRotate0;this.object.updateProjectionMatrix();this.dispatchEvent(D);this.update()};this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1);this.domElement.addEventListener("mousedown",function(b){a.autoRotate&&a.stopAutoRotateWhenTuch&&(a.autoRotate=!1,a.doStopAutoRotateOnTuch());if(!1!==a.enabled){b.preventDefault();if(0===b.button){if(!0===a.noRotate)return;e=d.ROTATE;m.set(b.clientX,
b.clientY)}else if(1===b.button){if(!0===a.noZoom)return;e=d.DOLLY;p.set(b.clientX,b.clientY)}else if(2===b.button){if(!0===a.noPan)return;e=d.PAN;r.set(b.clientX,b.clientY)}window.addEventListener("mousemove",A,!1);a.domElement.addEventListener("mouseup",x,!1);window.addEventListener("mouseup",x,!1)}},!1);this.domElement.addEventListener("mousewheel",B,!1);this.domElement.addEventListener("DOMMouseScroll",B,!1);this.domElement.addEventListener("keydown",function(b){a.autoRotate&&a.stopAutoRotateWhenTuch&&
(a.autoRotate=!1,a.doStopAutoRotateOnTuch());if(!1!==a.enabled&&!0!==a.noKeys&&!0!==a.noPan){var c=!1;switch(b.keyCode){case a.keys.UP:a.pan(new THREE.Vector2(0,a.keyPanSpeed));c=!0;break;case a.keys.BOTTOM:a.pan(new THREE.Vector2(0,-a.keyPanSpeed));c=!0;break;case a.keys.LEFT:a.pan(new THREE.Vector2(a.keyPanSpeed,0));c=!0;break;case a.keys.RIGHT:a.pan(new THREE.Vector2(-a.keyPanSpeed,0)),c=!0}c&&a.update()}},!1);this.domElement.addEventListener("touchstart",function(b){a.autoRotate&&a.stopAutoRotateWhenTuch&&
(a.autoRotate=!1,a.doStopAutoRotateOnTuch());if(!1!==a.enabled)switch(b.touches.length){case 1:if(!0===a.noRotate)break;e=d.TOUCH_ROTATE;m.set(b.touches[0].pageX,b.touches[0].pageY);break;case 2:if(!0===a.noZoom)break;e=d.TOUCH_DOLLY;var c=b.touches[0].pageX-b.touches[1].pageX;b=b.touches[0].pageY-b.touches[1].pageY;c=Math.sqrt(c*c+b*b);p.set(0,c);break;case 3:if(!0===a.noPan)break;e=d.TOUCH_PAN;r.set(b.touches[0].pageX,b.touches[0].pageY);break;default:e=d.NONE}},!1);this.domElement.addEventListener("touchend",
function(){!1!==a.enabled&&(e=d.NONE)},!1);this.domElement.addEventListener("touchmove",function(b){if(!1!==a.enabled){b.preventDefault();b.stopPropagation();var c=a.domElement===document?a.domElement.body:a.domElement;switch(b.touches.length){case 1:if(!0===a.noRotate)break;if(e!==d.TOUCH_ROTATE)break;k.set(b.touches[0].pageX,b.touches[0].pageY);l.subVectors(k,m);a.rotateLeft(2*Math.PI*l.x/c.clientWidth*a.rotateSpeed);a.rotateUp(2*Math.PI*l.y/c.clientHeight*a.rotateSpeed);m.copy(k);break;case 2:if(!0===
a.noZoom)break;if(e!==d.TOUCH_DOLLY)break;c=b.touches[0].pageX-b.touches[1].pageX;b=b.touches[0].pageY-b.touches[1].pageY;b=Math.sqrt(c*c+b*b);n.set(0,b);v.subVectors(n,p);0<v.y?a.dollyOut():a.dollyIn();p.copy(n);break;case 3:if(!0===a.noPan)break;if(e!==d.TOUCH_PAN)break;q.set(b.touches[0].pageX,b.touches[0].pageY);w.subVectors(q,r);a.pan(w);r.copy(q);break;default:e=d.NONE}}},!1)};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);
