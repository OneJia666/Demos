(function(){function f(){requestAnimationFrame(f);a.update();b.render(e,d)}var g,e,d,b,a;(function(){var f=new Howl({urls:music_urls,loop:!1,onend:function(){$("#music").data("playing",!1).attr("src",$("#music").attr("src-off"))}});$("#music").click(function(){var a=!0==$(this).data("playing");(a=!a)?f.play():f.pause();$(this).data("playing",a).attr("src",$(this).attr(a?"src-on":"src-off"))});$("#info").click(function(){$(".blurNeeded").addClass("blur");$(".info-ui").show()});$("#info-content").niceScroll();$("#info-back").click(function(){$(".info-ui").hide();$(".blurNeeded").removeClass("blur")});$("#qr").click(function(){$(".blurNeeded").addClass("blur");$(".qr-ui").show()});$("#qr-content").niceScroll();$("#qr-back").click(function(){$(".qr-ui").hide();$(".blurNeeded").removeClass("blur")});g=document.getElementById("ThreeJS");$container=$(g);e=new THREE.Scene;var c=$container.width(),l=$container.width();d=new THREE.PerspectiveCamera(45,c/l,.1,2E4);e.add(d);d.position.set(4,4,4);d.lookAt(e.position);b=Detector.webgl?new THREE.WebGLRenderer({antialias:!0}):new THREE.CanvasRenderer;b.setSize(c,l);g.appendChild(b.domElement);a=new THREE.OrbitControls(d,g);a.zoomSpeed=.6;a.rotateSpeed=1;a.autoRotate=!0;a.autoRotateSpeed=2;a.stopAutoRotateWhenTuch=!0;a.staticMoving=!1;a.dynamicDampingFactor=.1;
180>model_cam_vmax_deg&&(a.minPolarAngle=0,a.maxPolarAngle=Math.PI*model_cam_vmax_deg/180);model_lights&&(e.add(new THREE.AmbientLight(3355443)),e.add(new THREE.HemisphereLight(6710886,13421772,model_ltintensity)));$("#loading").show();var c=baseUrl+"objviewer/texture/skybox/",m=THREE.ImageUtils.loadTextureCube([c+"px.png",c+"nx.png",c+"py.png",c+"ny.png",c+"pz.png",c+"nz.png"]);m.format=THREE.RGBFormat;
(new THREE.OBJMTLLoader).load(model+"/model.tp",model_compress,model+"/model.txt",function(h){var c=new THREE.Box3;h.traverse(function(a){if(a instanceof THREE.Mesh){a.geometry.computeBoundingBox();model_option_cal_normal&&a.geometry.computeVertexNormals();c.union(a.geometry.boundingBox);for(var b=0;b<a.material.materials.length;b++)a.material.materials[b].side=THREE.DoubleSide,model_lights||(a.material.materials[b].emissive.copy(a.material.materials[b].color).multiplyScalar(model_ltintensity),a.material.materials[b].color.set(0,
0,0)),model_option_fix_refl&&a.material.materials[b].specular.setHex(10066329),0<model_env_refl_rate&&(a.material.materials[b].envMap=m,a.material.materials[b].reflectivity=model_env_refl_rate/100)}});
//h.scale.set(1.1, 1.1, 1.1);
var b=Math.max(c.max.x-c.min.x,c.max.y-c.min.y,c.max.z-c.min.z)/2;d.position.set(model_x*b*model_ex3,model_y*b*model_ex3,model_z*b*model_ex3); 

a.minDistance=b;a.maxDistance=10*b;a.saveResetState();h.position.copy(c.center()).negate();

e.model=h;e.add(h);$("#loading").hide()});var k=function(b){void 0===b&&(b=!0);b&&(a.autoRotate=!a.autoRotate);$("#ani").attr("src",$("#ani").attr(a.autoRotate?"src-play":"src-pause"))};$("#ani").click(k);a.stopAutoRotateOnTuchCallback=function(){k(!1)};$("#menu").click(function(){$(this).toggleClass("menuOpen");$("#options").hasClass("optionsInit")?$("#options").removeClass("optionsInit").addClass("optionsShow"):$("#options").toggleClass("optionsHide")});
$(window).resize(function(){d.aspect=$container.width()/$container.height();d.updateProjectionMatrix();b.setSize($container.width(),$container.height());b.render(e,d)}).resize();$("#reset").click(function(){a.reset();k(!1)});$(document).on("touchmove",function(a){a.preventDefault()},!1)})();f()})();
