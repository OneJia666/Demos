THREE.MTLLoader=function(a,c,b){this.baseUrl=a;this.options=c;this.crossOrigin=b};
THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(a,c,b,g){var d=this;b=new THREE.XHRLoader;b.setCrossOrigin(this.crossOrigin);b.load(a,function(a){c(d.parse(a))})},parse:function(a){var c=a.split("\n"),b={},g=/\s+/;a={};for(var d=0;d<c.length;d++){var e=c[d],e=e.trim();if(0!==e.length&&"#"!==e.charAt(0)){var h=e.indexOf(" "),f=0<=h?e.substring(0,h):e,f=f.toLowerCase(),e=0<=h?e.substring(h+1):"",e=e.trim();"newmtl"===f?(b={name:e},a[e]=b):b&&("ka"===f||"kd"===f||"ks"===f?(e=e.split(g,
3),b[f]=[parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])]):b[f]=e)}}c=new THREE.MTLLoader.MaterialCreator(this.baseUrl,this.options);c.setMaterials(a);return c}};THREE.MTLLoader.MaterialCreator=function(a,c){this.baseUrl=a;this.options=c;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide;this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping};
THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,setMaterials:function(a){this.materialsInfo=this.convert(a);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(a){if(!this.options)return a;var c={},b;for(b in a){var g=a[b],d={};c[b]=d;for(var e in g){var h=!0,f=g[e],k=e.toLowerCase();switch(k){case "kd":case "ka":case "ks":this.options&&this.options.normalizeRGB&&(f=[f[0]/255,f[1]/255,f[2]/255]);this.options&&this.options.ignoreZeroRGBs&&
0===f[0]&&0===f[1]&&0===f[1]&&(h=!1);break;case "d":this.options&&this.options.invertTransparency&&(f=1-f)}h&&(d[k]=f)}}return c},preload:function(){for(var a in this.materialsInfo)this.create(a)},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0,c;for(c in this.materialsInfo)this.materialsArray[a]=this.create(c),this.nameLookup[c]=a,a++;return this.materialsArray},create:function(a){void 0===this.materials[a]&&this.createMaterial_(a);return this.materials[a]},createMaterial_:function(a){var c=
this.materialsInfo[a],b={name:a,side:this.side},g;for(g in c){var d=c[g];switch(g.toLowerCase()){case "kd":b.diffuse=(new THREE.Color).fromArray(d);break;case "ka":b.ambient=(new THREE.Color).fromArray(d);break;case "ks":b.specular=(new THREE.Color).fromArray(d);break;case "map_kd":""!==d&&(b.map=this.loadTexture(this.baseUrl+d),b.map.wrapS=this.wrap,b.map.wrapT=this.wrap);break;case "map_bump":""!==d&&(b.normalMap=this.loadTexture(this.baseUrl+d),b.normalMap.wrapS=this.wrap,b.normalMap.wrapT=this.wrap);
break;case "map_refl":""!==d&&(b.specularMap=this.loadTexture(this.baseUrl+d),b.specularMap.wrapS=this.wrap,b.specularMap.wrapT=this.wrap);break;case "ns":b.shininess=d;break;case "d":1>d&&(b.transparent=!0,b.opacity=d)}}b.diffuse&&(b.ambient||(b.ambient=b.diffuse),b.color=b.diffuse);this.materials[a]=new THREE.MeshPhongMaterial(b);return this.materials[a]},loadTexture:function(a,c,b,g){if(/\.dds$/i.test(a))var d=THREE.ImageUtils.loadCompressedTexture(a,c,b,g);else g=new Image,d=new THREE.Texture(g,
c),c=new THREE.ImageLoader,c.crossOrigin=this.crossOrigin,c.load(a,function(a){d.image=THREE.MTLLoader.ensurePowerOfTwo_(a);d.needsUpdate=!0;b&&b(d)});return d}};
THREE.MTLLoader.ensurePowerOfTwo_=function(a){if(!THREE.MTLLoader.isPowerOfTwo_(a.width)||!THREE.MTLLoader.isPowerOfTwo_(a.height)){var c=document.createElement("canvas");c.width=THREE.MTLLoader.nextHighestPowerOfTwo_(a.width);c.height=THREE.MTLLoader.nextHighestPowerOfTwo_(a.height);c.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,c.width,c.height);return c}return a};THREE.MTLLoader.isPowerOfTwo_=function(a){return 0===(a&a-1)};
THREE.MTLLoader.nextHighestPowerOfTwo_=function(a){--a;for(var c=1;32>c;c<<=1)a|=a>>c;return a+1};THREE.EventDispatcher.prototype.apply(THREE.MTLLoader.prototype);
